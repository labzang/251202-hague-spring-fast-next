{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/hi/Documents/my-project/auth-login/www.labzang.com/app/api/auth/kakao/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  // 가능한 백엔드 경로들 (우선순위 순)\r\n  // 백엔드 컨트롤러의 @RequestMapping과 @PostMapping 조합에 따라 경로가 달라집니다\r\n  const possiblePaths = [\r\n    '/api/auth/kakao/login',  // @RequestMapping(\"/api/auth/kakao\") + @PostMapping(\"/login\")\r\n    '/auth/kakao/login',      // @RequestMapping(\"/auth/kakao\") + @PostMapping(\"/login\")\r\n    '/api/kakao/login',       // @RequestMapping(\"/api/kakao\") + @PostMapping(\"/login\")\r\n    '/kakao/login',           // @RequestMapping(\"/kakao\") + @PostMapping(\"/login\")\r\n    '/login',                 // @RequestMapping(\"/\") + @PostMapping(\"/login\")\r\n  ];\r\n\r\n  const baseUrl = 'http://localhost:8080';\r\n  \r\n  try {\r\n    // 요청 본문 가져오기\r\n    const body = await request.json().catch(() => ({}));\r\n    \r\n    let lastError: Error | null = null;\r\n    \r\n    // 여러 경로를 시도\r\n    for (const path of possiblePaths) {\r\n      const backendUrl = `${baseUrl}${path}`;\r\n      \r\n      try {\r\n        console.log(`[API 프록시] 시도 중: ${backendUrl}`);\r\n        \r\n        const response = await fetch(backendUrl, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Accept': 'application/json',\r\n          },\r\n          body: JSON.stringify(body),\r\n        });\r\n\r\n        console.log(`[API 프록시] 응답 상태: ${response.status} ${response.statusText} (${backendUrl})`);\r\n\r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          console.log(`[API 프록시] 성공: ${backendUrl}`);\r\n          return NextResponse.json(data);\r\n        } else if (response.status !== 404) {\r\n          // 404가 아닌 다른 에러는 즉시 반환\r\n          const errorText = await response.text().catch(() => '');\r\n          console.error(`[API 프록시] 에러 (${response.status}): ${errorText}`);\r\n          return NextResponse.json(\r\n            { error: `HTTP ${response.status}: ${errorText || response.statusText}`, path: backendUrl },\r\n            { status: response.status }\r\n          );\r\n        }\r\n        // 404인 경우 다음 경로 시도\r\n        lastError = new Error(`404 Not Found: ${backendUrl}`);\r\n      } catch (fetchError) {\r\n        console.error(`[API 프록시] fetch 에러 (${backendUrl}):`, fetchError);\r\n        lastError = fetchError instanceof Error ? fetchError : new Error(String(fetchError));\r\n        // 네트워크 에러가 아닌 경우 계속 시도\r\n        if (fetchError instanceof TypeError && fetchError.message.includes('fetch')) {\r\n          // 네트워크 에러는 모든 경로에서 실패할 것이므로 즉시 반환\r\n          return NextResponse.json(\r\n            { \r\n              error: '서버에 연결할 수 없습니다. 백엔드 서버(localhost:8080)가 실행 중인지 확인해주세요.',\r\n              attemptedPath: backendUrl\r\n            },\r\n            { status: 500 }\r\n          );\r\n        }\r\n      }\r\n    }\r\n\r\n    // 모든 경로가 실패한 경우\r\n    return NextResponse.json(\r\n      { \r\n        error: '엔드포인트를 찾을 수 없습니다. 다음 경로들을 시도했습니다:',\r\n        attemptedPaths: possiblePaths.map(p => `${baseUrl}${p}`),\r\n        suggestion: '백엔드 서버의 실제 엔드포인트 경로를 확인해주세요.'\r\n      },\r\n      { status: 404 }\r\n    );\r\n  } catch (error) {\r\n    console.error('[API 프록시] 예상치 못한 에러:', error);\r\n    return NextResponse.json(\r\n      { \r\n        error: '서버 오류가 발생했습니다.',\r\n        details: error instanceof Error ? error.message : String(error)\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAoB;IAC7C,uBAAuB;IACvB,2DAA2D;IAC3D,MAAM,gBAAgB;QACpB;QACA;QACA;QACA;QACA;KACD;IAED,MAAM,UAAU;IAEhB,IAAI;QACF,aAAa;QACb,MAAM,OAAO,MAAM,QAAQ,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QAEjD,IAAI,YAA0B;QAE9B,YAAY;QACZ,KAAK,MAAM,QAAQ,cAAe;YAChC,MAAM,aAAa,GAAG,UAAU,MAAM;YAEtC,IAAI;gBACF,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,YAAY;gBAE3C,MAAM,WAAW,MAAM,MAAM,YAAY;oBACvC,QAAQ;oBACR,SAAS;wBACP,gBAAgB;wBAChB,UAAU;oBACZ;oBACA,MAAM,KAAK,SAAS,CAAC;gBACvB;gBAEA,QAAQ,GAAG,CAAC,CAAC,iBAAiB,EAAE,SAAS,MAAM,CAAC,CAAC,EAAE,SAAS,UAAU,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;gBAExF,IAAI,SAAS,EAAE,EAAE;oBACf,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,QAAQ,GAAG,CAAC,CAAC,cAAc,EAAE,YAAY;oBACzC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAC3B,OAAO,IAAI,SAAS,MAAM,KAAK,KAAK;oBAClC,uBAAuB;oBACvB,MAAM,YAAY,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM;oBACpD,QAAQ,KAAK,CAAC,CAAC,cAAc,EAAE,SAAS,MAAM,CAAC,GAAG,EAAE,WAAW;oBAC/D,OAAO,gJAAY,CAAC,IAAI,CACtB;wBAAE,OAAO,CAAC,KAAK,EAAE,SAAS,MAAM,CAAC,EAAE,EAAE,aAAa,SAAS,UAAU,EAAE;wBAAE,MAAM;oBAAW,GAC1F;wBAAE,QAAQ,SAAS,MAAM;oBAAC;gBAE9B;gBACA,mBAAmB;gBACnB,YAAY,IAAI,MAAM,CAAC,eAAe,EAAE,YAAY;YACtD,EAAE,OAAO,YAAY;gBACnB,QAAQ,KAAK,CAAC,CAAC,oBAAoB,EAAE,WAAW,EAAE,CAAC,EAAE;gBACrD,YAAY,sBAAsB,QAAQ,aAAa,IAAI,MAAM,OAAO;gBACxE,uBAAuB;gBACvB,IAAI,sBAAsB,aAAa,WAAW,OAAO,CAAC,QAAQ,CAAC,UAAU;oBAC3E,kCAAkC;oBAClC,OAAO,gJAAY,CAAC,IAAI,CACtB;wBACE,OAAO;wBACP,eAAe;oBACjB,GACA;wBAAE,QAAQ;oBAAI;gBAElB;YACF;QACF;QAEA,gBAAgB;QAChB,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,gBAAgB,cAAc,GAAG,CAAC,CAAA,IAAK,GAAG,UAAU,GAAG;YACvD,YAAY;QACd,GACA;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG,OAAO;QAC3D,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}